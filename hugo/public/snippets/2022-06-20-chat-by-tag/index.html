<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
  
  

  <meta name="author" content="David Bieber">

  
  
  
    
  
  <meta name="description" content="I don&rsquo;t have a comments section on my website, but I do like when people reach out to me by email. I am thinking about an idea for adding chat to my website, but the experience I have in mind is different from any chat or comments section that I&rsquo;ve seen before. Here&rsquo;s what I&rsquo;m thinking about and why &ndash; please do let me know if it exists.
At the end of each snippet there would be a badge for each tag associated with that snippet, as there already is today.">

  
  <link rel="alternate" hreflang="en-us" href="https://davidbieber.com/snippets/2022-06-20-chat-by-tag/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-34570499-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-34570499-2', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu6034018d2bd3ec10a6270f0656007019_39811_32x32_fill_box_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu6034018d2bd3ec10a6270f0656007019_39811_192x192_fill_box_center_2.png">

  <link rel="canonical" href="https://davidbieber.com/snippets/2022-06-20-chat-by-tag/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@Bieber">
  <meta property="twitter:creator" content="@Bieber">
  
  <meta property="og:site_name" content="David Bieber">
  <meta property="og:url" content="https://davidbieber.com/snippets/2022-06-20-chat-by-tag/">
  <meta property="og:title" content="Chat by Tag | David Bieber">
  <meta property="og:description" content="I don&rsquo;t have a comments section on my website, but I do like when people reach out to me by email. I am thinking about an idea for adding chat to my website, but the experience I have in mind is different from any chat or comments section that I&rsquo;ve seen before. Here&rsquo;s what I&rsquo;m thinking about and why &ndash; please do let me know if it exists.
At the end of each snippet there would be a badge for each tag associated with that snippet, as there already is today."><meta property="og:image" content="img/map[gravatar:%!s(bool=true) shape:circle]">
  <meta property="twitter:image" content="img/map[gravatar:%!s(bool=true) shape:circle]"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2022-06-20T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2022-06-20T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Chat by Tag | David Bieber</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">David Bieber</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">David Bieber</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/posts"><span>Writing</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/projects"><span>Projects</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Chat by Tag</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    
  </span>
  

  

  

  
  
  

  
  

</div>

  
</div>




  <div class="article-container">

    <div class="article-style" id="article-content">
      <p>I don&rsquo;t have a comments section on my website, but I do like when people reach out to me by email.
I am thinking about an idea for adding chat to my website, but the experience I have in mind is different from any chat or comments section that I&rsquo;ve seen before.
Here&rsquo;s what I&rsquo;m thinking about and why &ndash; please do let me know if it exists.</p>
<p>At the end of each snippet there would be a badge for each tag associated with that snippet, as there already is today.
Each badge would indicate that there is a chat thread available for that tag.
E.g. it would show the number of active users and amount of recent activity in the chatroom.
Clicking the badge would take you to the tag&rsquo;s page, which would list all the snippets having that tag.
The tag page would now also house the tag&rsquo;s chat thread.</p>
<p>On the tag page you could engage in real time chat, and your messages would stay up for a week (or until I take them down, in the case of spam).</p>
<p>My website is not particularly heavily trafficked, but enough people email me about the things I write that this features interests me.
I don&rsquo;t envision any of the chats having any content the majority of the time.
I would set the lifetime of a message to just one week.
Between the low traffic and ephemerality of the messages, most of the chats would be empty most of the time.
I would set up email notifications for myself though, so that I know if someone does post a message.
So at the very least, I could reply, even if few others see the messages.</p>
<p>As often happens when writing a snippet about an idea I&rsquo;ve had, I start looking into how to implement it concurrently with writing it.
I&rsquo;ve looked at Rocket.Chat, Slack, and Discord, and am currently investigating whether using widgetbot.io to provide access to a Discord server might be a solid solution here.
What follows is my initial attempt at including Discord directly in this snippet.</p>
<details id="chat-details-inline">
  <summary markdown="span">Expand this to see the embedded chat.</summary>
  <widgetbot
    server="695290335823265862"
    channel="988521423603654686"
    width="100%"
    height="600">
  </widgetbot>
</details><br/>
<p>It seems to be working quite well.</p>
<p>So, given that this tool is readily available, I will compromise on my original vision some.
I think what I&rsquo;ll do now is (1) find a way to lazily load the chat so people who don&rsquo;t want to deal with it aren&rsquo;t bothered by it,
and then (2) I&rsquo;ll add it (behind an expandable section) to every snippet and every tags page.</p>
<p>I&rsquo;ll set up a Discord server with one channel per tag. On the tag pages, the chat will default open to that tag&rsquo;s channel.
On the individual snippets, the chat will default open to the first tag present on the page.
Users can easily switch to other channels if they so desire.</p>
<p>So, how to lazy load? This turned out to be simple enough to implement quite quickly. I added some JavaScript to the page that loads the widgetbot JavaScript only when the collapsed chat is expanded. It looks like this:</p>
<pre><code class="language-html">&lt;script&gt;
let chatLoaded = false;
const details = document.querySelector('#chat-details');
details.addEventListener(&quot;toggle&quot;, event =&gt; {
  if (details.open &amp;&amp; !chatLoaded) {
    const script = document.createElement('script');
    script.src = &quot;https://cdn.jsdelivr.net/npm/@widgetbot/html-embed&quot;;
    document.head.appendChild(script);
    chatLoaded = true;
  }
});
&lt;/script&gt;
</code></pre>
<p>(Why am I showing this code? It is not germane to the story. A: This is a snippet, and so I guess I do not curate the content like I would if the goal were a proper story. It&rsquo;s meant for future me as much as for anyone else.)</p>
<script>
let chatLoadedInline = false;
const detailsInline = document.querySelector('#chat-details-inline');
detailsInline.addEventListener("toggle", event => {
  if (detailsInline.open && !chatLoadedInline) {
    const script = document.createElement('script');
    script.src = "https://cdn.jsdelivr.net/npm/@widgetbot/html-embed";
    document.head.appendChild(script);
    chatLoadedInline = true;
  }
});
</script>
<p>Having set up the lazy loading, the next step was to create channels for each of the tags on my site.
There are a lot of tags, so I used Browserflow to do this quickly. A joy as always.</p>
<p>Finally, I&rsquo;ll have to update my website so that the appropriate chat gets added to the appropriate page. (I&rsquo;m back, and that&rsquo;s done now :).)</p>
<p>I&rsquo;ve tagged this post with &ldquo;Ask Me Anywhere&rdquo; because, like my original Ask Me Anywhere ideas, this is about allowing for more direct engagement between me and people on the site. I&rsquo;ve also tagged this &ldquo;Snippets&rdquo;, because it&rsquo;s primarily about a change to the snippets section of my website, and &ldquo;Browserflow&rdquo; because Browserflow was a joy to use for setting up this new system.</p>
<p>At this point, I&rsquo;m concluding the snippet. The system is up and running. That was certainly not my expectation when I started writing this, but I&rsquo;m delighted by the progress I made.</p>
<details>
  <summary>As an aside, David, expand this for a reminder of how to add a new tag.</summary>
There will be some maintenance work necessary whenever I add a snippet with a new tag. Let me summarize the maintenance for myself here for easy reference:
<ol>
<li>Create a new channel in the Discord.</li>
<li>Add the tag name and channel id to the map at the top of the 
<a href="https://github.com/dbieber/davidbieber.com/blob/master/hugo/layouts/partials/discussion.html" target="_blank" rel="noopener">discussion.html partial</a>.</li>
</ol>
<p>The site won&rsquo;t fail to build if you forget to do this; it will just have a broken chat section.</p>
</details>
<p>That should be it. See you in the chats!</p>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/snippets/">snippets</a>
  
  <a class="badge badge-light" href="/tags/ask-me-anywhere/">ask-me-anywhere</a>
  
  <a class="badge badge-light" href="/tags/browserflow/">browserflow</a>
  
  <a class="badge badge-light" href="/tags/taking-silly-ideas-seriously/">taking-silly-ideas-seriously</a>
  
</div>










  
  
  
  

<div class="article-widget content-widget-hr">
  <details id="chat-details">
    <summary><h3>Discussion 💬</h3></summary>
    
    <widgetbot
      server="695290335823265862"
      channel=988521423603654686
      width="100%"
      height="600">
    </widgetbot>
  </details>
</div>

<script>
let chatLoaded = false;
const details = document.querySelector('#chat-details');
details.addEventListener("toggle", event => {
  if (details.open && !chatLoaded) {
    const script = document.createElement('script');
    script.src = "https://cdn.jsdelivr.net/npm/@widgetbot/html-embed";
    document.head.appendChild(script);
    chatLoaded = true;
  }
});
</script>




  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/snippets/2020-10-06-introducing-the-snippet-queue/">Introducing the Snippet Queue</a></li>
      
      <li><a href="/snippets/2020-01-25-ask-me-anywhere/">Ask Me Anywhere</a></li>
      
      <li><a href="/snippets/2022-06-21-using-discord/">Using Discord for my website&#39;s comments section</a></li>
      
      <li><a href="/snippets/2022-03-07-snippets-on-gng-ii/">Writing Another Snippet on Go Note Go</a></li>
      
    </ul>
  </div>
  












  
  





  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://davidbieber.com/">David Bieber</a></h5>
      
      
      <ul class="network-icon" aria-hidden="true">
  
</ul>

    </div>
  </div>








  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/javascript.min.js"></script>
        
      

    

    
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    

    <script crossorigin src="//unpkg.com/react@16/umd/react.production.min.js"></script>
<script crossorigin src="//unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>

<script src="/js/academic.min.c816d323c3a55093dae0829b44ea1ca8.js"></script>

<script src="//code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="//static.tumblr.com/fpifyru/AKFlv9zdu/embedgist.js"></script>


<script src="//www.gstatic.com/firebasejs/7.6.2/firebase-app.js"></script>
<script src="//www.gstatic.com/firebasejs/7.6.2/firebase-analytics.js"></script>
<script src="//www.gstatic.com/firebasejs/7.6.2/firebase-firestore.js"></script>

<script>
  var firebaseConfig = {
    apiKey: "AIzaSyDZSDKaAmz-UUyaL1IZMi4QO_q4Jouko2c",
    authDomain: "ask-me-anywhere.firebaseapp.com",
    databaseURL: "https://ask-me-anywhere.firebaseio.com",
    projectId: "ask-me-anywhere",
    storageBucket: "ask-me-anywhere.appspot.com",
    messagingSenderId: "123038093749",
    appId: "1:123038093749:web:e8ce89651fcf1371d109fc",
    measurementId: "G-JLDGL73R1B"
  };
  
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
</script>

    



  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
