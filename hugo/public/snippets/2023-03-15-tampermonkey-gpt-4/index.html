<!DOCTYPE html>
<html lang="en-us">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="generator" content="Source Themes Academic 4.8.0">

  

  
  
  
  
  
    
    
    
      
    
    
    
  
  

  <meta name="author" content="David Bieber">

  
  
  
    
  
  <meta name="description" content="Today I used GPT-4 to implement my first ever Tampermonkey script. It took well under half an hour, which is likely many times faster than it would have taken me alone. I am blown away by GPT-4&rsquo;s programming capabilities.
It started with a simple feature request for the Hypothesis browser extension. For context, Hypothesis is a tool for taking notes on the web, including on PDFs. I use it to take notes on machine learning pdfs on Arxiv.">

  
  <link rel="alternate" hreflang="en-us" href="https://davidbieber.com/snippets/2023-03-15-tampermonkey-gpt-4/">

  


  
  
  
  <meta name="theme-color" content="#2962ff">
  

  
  

  
  
  
  
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">

    
    
    
      
    
    
      
      
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
    

    

    

    
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
    
      

      
      

      
        <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
      
    
      

      
      

      
    
      

      
      

      
    
      

      
      
        
      

      
    
      

      
      

      
    

  

  
  
  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,700%7CRoboto:400,400italic,700%7CRoboto+Mono&display=swap">
  

  
  
  
  
  <link rel="stylesheet" href="/css/academic.css">

  





<script async src="https://www.googletagmanager.com/gtag/js?id=UA-34570499-2"></script>
<script>
  window.dataLayer = window.dataLayer || [];

  function gtag() {
      dataLayer.push(arguments);
  }

  function trackOutboundLink(url, target) {
    gtag('event', 'click', {
         'event_category': 'outbound',
         'event_label': url,
         'transport_type': 'beacon',
         'event_callback': function () {
           if (target !== '_blank') {
             document.location = url;
           }
         }
    });
    console.debug("Outbound link clicked: " + url);
  }

  function onClickCallback(event) {
    if ((event.target.tagName !== 'A') || (event.target.host === window.location.host)) {
      return;
    }
    trackOutboundLink(event.target, event.target.getAttribute('target'));  
  }

  gtag('js', new Date());
  gtag('config', 'UA-34570499-2', {});

  
  document.addEventListener('click', onClickCallback, false);
</script>


  


  

  <link rel="manifest" href="/index.webmanifest">
  <link rel="icon" type="image/png" href="/images/icon_hu6034018d2bd3ec10a6270f0656007019_39811_32x32_fill_box_center_2.png">
  <link rel="apple-touch-icon" type="image/png" href="/images/icon_hu6034018d2bd3ec10a6270f0656007019_39811_192x192_fill_box_center_2.png">

  <link rel="canonical" href="https://davidbieber.com/snippets/2023-03-15-tampermonkey-gpt-4/">

  
  
  
  
  
    
    
  
  
  <meta property="twitter:card" content="summary">
  
  <meta property="twitter:site" content="@Bieber">
  <meta property="twitter:creator" content="@Bieber">
  
  <meta property="og:site_name" content="David Bieber">
  <meta property="og:url" content="https://davidbieber.com/snippets/2023-03-15-tampermonkey-gpt-4/">
  <meta property="og:title" content="Writing a Tampermonkey Script with GPT-4 | David Bieber">
  <meta property="og:description" content="Today I used GPT-4 to implement my first ever Tampermonkey script. It took well under half an hour, which is likely many times faster than it would have taken me alone. I am blown away by GPT-4&rsquo;s programming capabilities.
It started with a simple feature request for the Hypothesis browser extension. For context, Hypothesis is a tool for taking notes on the web, including on PDFs. I use it to take notes on machine learning pdfs on Arxiv."><meta property="og:image" content="img/map[gravatar:%!s(bool=true) shape:circle]">
  <meta property="twitter:image" content="img/map[gravatar:%!s(bool=true) shape:circle]"><meta property="og:locale" content="en-us">
  
    
      <meta property="article:published_time" content="2023-03-15T00:00:00&#43;00:00">
    
    <meta property="article:modified_time" content="2023-03-15T00:00:00&#43;00:00">
  

  



  


  


  





  <title>Writing a Tampermonkey Script with GPT-4 | David Bieber</title>

</head>

<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/">David Bieber</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/">David Bieber</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/"><span>Home</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/posts"><span>Writing</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="/projects"><span>Projects</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  <article class="article">

  












  

  
  
  
<div class="article-container pt-3">
  <h1 itemprop="name">Writing a Tampermonkey Script with GPT-4</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    
  </span>
  

  

  

  
  
  

  
  

</div>

  
</div>




  <div class="article-container">

    <div class="article-style" id="article-content">
      <p>Today I used 
<a href="https://openai.com/research/gpt-4" target="_blank" rel="noopener">GPT-4</a> to implement my first ever 
<a href="https://www.tampermonkey.net/" target="_blank" rel="noopener">Tampermonkey</a> script. It took well under half an hour, which is likely many times faster than it would have taken me alone. I am blown away by GPT-4&rsquo;s programming capabilities.</p>
<p>It started with 
<a href="https://github.com/hypothesis/h/issues/7868" target="_blank" rel="noopener">a simple feature request</a> for 
<a href="https://hypothes.is/" target="_blank" rel="noopener">the Hypothesis browser extension</a>. For context, Hypothesis is a tool for taking notes on the web, including on PDFs.
I use it to take notes on machine learning pdfs on Arxiv. It&rsquo;s a great tool, but it has a limitation: when browsing my notes, it only shows the ID of the pdf, not the name of the PDF. This makes it hard to find what I&rsquo;m looking for.
So, I made a feature request on GitHub, asking if the developers of hypothesis could make the titles of pages editable. This would allow me to replace the useless IDs with the more useful titles on pdfs whenever I take notes on them.</p>
<p>Someone suggested I could write a Greasemonkey script to do this. Their exact suggestion was:</p>
<pre><code class="language-text">You can write a Greasemonkey script which parses the Arxiv PDF links on Hypothesis pages, gathers their ArxivID, queries the Arxiv ATOM API with one HTTP call (using an aggregated list of ArxivIDs as a search parameter) and updates Arxiv PDF links titles on Hypothesis pages.

Example of an API query with multiple ArxivIDs: https://export.arxiv.org/api/query?id_list=2007.12026,1706.03741,1603.00022
</code></pre>
<p>At first I thought this wasn&rsquo;t such a helpful suggestion. Writing a Greasemonkey script is time consuming and it wouldn&rsquo;t be worthwhile for such a small usability improvement. Then I remembered GPT-4. So, I decided to proceed.</p>
<p>Greasemonkey is for Firefox. Tampermonkey is the equivalent for Chrome. I use Chrome, so I would need a Tampermonkey script.</p>
<p>I used GPT-4 to write the script. This is not a trivial script by any stretch of the imagination. It involves parsing the DOM on the Hypothesis page to find references to Arxiv, querying the Arxiv API (but only after dividing the IDs into batches), parsing the XML results returned by the API, and again parsing and updating the DOM on the Hypothesis page to update the results. In order to do all this, the developer needs to understand what the DOM looks like on the Hypothesis page, and what the format of the Arxiv API results XML looks like, in order to get the parsing correct. It took a few back-and-forths, but GPT-4 did a remarkable job of writing the script.</p>
<p>Here&rsquo;s what our interaction looked like:</p>
<pre><code class="language-text">1. Me (Initial prompt): `Write a tampermonkey script that parses the Arxiv PDF links on Hypothesis pages, gathers their ArxivID, queries the Arxiv ATOM API with one HTTP call (using an aggregated list of ArxivIDs as a search parameter) and updates Arxiv PDF links titles on Hypothesis pages.`

GPT-4: &lt;Attempt 1 at script&gt;

2. Me: `The HTML for one of the rows on the hypothesis page is:
...
In this example the text to update is &quot;1904.09751.pdf&quot; which should be replaced with the title`

GPT-4: &lt;Attempt 2 at script&gt;

3. Me: How do I view the script's logs if it isn't working?

GPT-4: Explains how to get the logs

4. Me: _&lt;pastes error message&gt;_

GPT-4: _&lt;Fixes error message&gt;_

5. Me: Here is the format returned by the arxiv.org api call we're making: _&lt;pastes example Arxiv API output&gt;_

Notice the arxiv id can end with e.g. v1 -- we can safely strip that part.
Let's also add debug logging, e.g. logging the arxivIDs found on the hypothesis page and any other useful debug info

GPT-4: _&lt;Fixes the v1 stripping and adds logging&gt;_

6. Me: The arxiv API only returns the results for the first 10 ids passed to it.

GPT-4: _&lt;Adds batching of API calls&gt;_

7. Me: _&lt;Describes an edge case&gt;_: The title can also be something like 1607.06450v1.pdf -- in that case we should get the id as 1607.06450, dropping the &quot;v1&quot; part

GPT-4: _&lt;Handles the edge case&gt;_
</code></pre>
<p>
<a href="https://gist.github.com/dbieber/c3198a1ceeb86fa823df305a76907afa" target="_blank" rel="noopener">Here&rsquo;s the final script it came up with.</a>. It&rsquo;s 112 lines of reasonably well organized Javascript. And it gets the job done. Now, when I visit my Hypothesis notes, the title of every paper is shown clearly, not just its inscrutable Arxiv ID.</p>
<p>As you can see from the abbreviated transcript above, there were only seven back-and-forths between me and the model. In that time, the model behaved sensibly all throughout. It never once made a silly slip-up, which was common behavior for previous models.</p>
<p>In those seven back-and-forths, I used one (1) to share the overall task, four (2, 5, 6, and 7) to share information about the data being manipulated, one (3) to ask for help, and one (4) to paste an error message for GPT to debug.
If I&rsquo;d had more foresight, I expect I could have included the data from (2, 5, 6, and 7) all in my initial query.</p>
<p>During development, I would manually copy GPT-4&rsquo;s code into Tampermonkey, save it, and refresh Hypothesis to see the changes. If I got an error, or if the behavior wasn&rsquo;t exactly what I wanted, I simply told GPT and waited for it to update the code. GPT-4&rsquo;s output generation is slow compared to other AI models, and there was some waiting time as it wrote its responses. I really felt like I had delegated work to an AI worker, and could easily see myself managing a fleet of such workers, all working toward different goals concurrently. I can also see a future where one AI worker is itself responsible for delegating work to a fleet of such workers; it doesn&rsquo;t need to be a human doing all that delegation.</p>
<p>Overall, GPT-4 behaved as a professional and speedy developer throughout the entire duration of the task. I would be delighted to work with them again on future projects.</p>

    </div>

    





<div class="article-tags">
  
  <a class="badge badge-light" href="/tags/note-taking/">note-taking</a>
  
  <a class="badge badge-light" href="/tags/ai/">ai</a>
  
  <a class="badge badge-light" href="/tags/javascript/">javascript</a>
  
</div>










  
  
  
  

<div class="article-widget content-widget-hr">
  <details id="chat-details">
    <summary><h3>Discussion 💬</h3></summary>
    
    <widgetbot
      server="695290335823265862"
      channel=988521453764874310
      width="100%"
      height="600">
    </widgetbot>
  </details>
</div>

<script>
let chatLoaded = false;
const details = document.querySelector('#chat-details');
details.addEventListener("toggle", event => {
  if (details.open && !chatLoaded) {
    const script = document.createElement('script');
    script.src = "https://cdn.jsdelivr.net/npm/@widgetbot/html-embed";
    document.head.appendChild(script);
    chatLoaded = true;
  }
});
</script>




  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/snippets/2023-03-18-personal-newsletter/">Personal Newsletter (Just for me)</a></li>
      
      <li><a href="/snippets/2023-02-24-everyday-robots/">Everyday Robots</a></li>
      
      <li><a href="/snippets/2023-01-16-go-note-go-features/">A Complete and Concise List of Go Note Go&#39;s Features</a></li>
      
      <li><a href="/snippets/2023-01-04-sleeping-with-gpt/">Sleeping with GPT</a></li>
      
    </ul>
  </div>
  












  
  





  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://davidbieber.com/">David Bieber</a></h5>
      
      
      <ul class="network-icon" aria-hidden="true">
  
</ul>

    </div>
  </div>








  </div>
</article>

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/python.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/javascript.min.js"></script>
        
      

    

    
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    

    <script crossorigin src="//unpkg.com/react@16/umd/react.production.min.js"></script>
<script crossorigin src="//unpkg.com/react-dom@16/umd/react-dom.production.min.js"></script>

<script src="/js/academic.min.c816d323c3a55093dae0829b44ea1ca8.js"></script>

<script src="//code.jquery.com/jquery-3.4.1.min.js"></script>
<script src="//static.tumblr.com/fpifyru/AKFlv9zdu/embedgist.js"></script>


<script src="//www.gstatic.com/firebasejs/7.6.2/firebase-app.js"></script>
<script src="//www.gstatic.com/firebasejs/7.6.2/firebase-analytics.js"></script>
<script src="//www.gstatic.com/firebasejs/7.6.2/firebase-firestore.js"></script>

<script>
  var firebaseConfig = {
    apiKey: "AIzaSyDZSDKaAmz-UUyaL1IZMi4QO_q4Jouko2c",
    authDomain: "ask-me-anywhere.firebaseapp.com",
    databaseURL: "https://ask-me-anywhere.firebaseio.com",
    projectId: "ask-me-anywhere",
    storageBucket: "ask-me-anywhere.appspot.com",
    messagingSenderId: "123038093749",
    appId: "1:123038093749:web:e8ce89651fcf1371d109fc",
    measurementId: "G-JLDGL73R1B"
  };
  
  firebase.initializeApp(firebaseConfig);
  firebase.analytics();
</script>

    



  
  
  <div class="container">
    <footer class="site-footer">
  

  <p class="powered-by">
    

    

    
    <span class="float-right" aria-hidden="true">
      <a href="#" class="back-to-top">
        <span class="button_icon">
          <i class="fas fa-chevron-up fa-2x"></i>
        </span>
      </a>
    </span>
    
  </p>
</footer>

  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
