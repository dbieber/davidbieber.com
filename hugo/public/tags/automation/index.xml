<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Automation | David Bieber</title>
    <link>https://davidbieber.com/tags/automation/</link>
      <atom:link href="https://davidbieber.com/tags/automation/index.xml" rel="self" type="application/rss+xml" />
    <description>Automation</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><lastBuildDate>Sun, 02 Jan 2022 01:00:00 +0000</lastBuildDate>
    <image>
      <url>img/map[gravatar:%!s(bool=true) shape:circle]</url>
      <title>Automation</title>
      <link>https://davidbieber.com/tags/automation/</link>
    </image>
    
    <item>
      <title>Go Note Go Messager without Pixel-Space Automation</title>
      <link>https://davidbieber.com/snippets/2022-01-02-pixel-space-automation/</link>
      <pubDate>Sun, 02 Jan 2022 01:00:00 +0000</pubDate>
      <guid>https://davidbieber.com/snippets/2022-01-02-pixel-space-automation/</guid>
      <description>&lt;p&gt;&lt;em&gt;This snippet was originally going to be about pixel-space automation. Then I found I didn&amp;rsquo;t need it for what I wanted to do: sending messages to Twitter, Facebook, Slack, and Discord from Go Note Go, Roam Research, and Bieber Bot.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Happy New Year! I&amp;rsquo;d really like to automate Mac apps that don&amp;rsquo;t expose actions to Automator
using pixel-space navigation and clicks and typing to control the automation. This is why and how.&lt;/p&gt;
&lt;p&gt;(Update from the end of the snippet: By the time I finished writing the snippet, I had automated everything I intended to using browser automation in Browserflow, never once needing to automate Ferdi. I still think pixel-space automation would be wonderful, but my initial motivation for it turns out to be insufficient.)&lt;/p&gt;
&lt;h3 id=&#34;motivation-improving-messager-by-automating-ferdi&#34;&gt;Motivation: Improving Messager by Automating Ferdi&lt;/h3&gt;
&lt;p&gt;I have a side project &amp;ldquo;Messager&amp;rdquo; that allows for programmatically sending and receiving messages
across a wide variety of messaging services.
I also use Ferdi for manually managing an even wider variety of messaging services.&lt;/p&gt;
&lt;p&gt;Currently Messager supports
Facebook Messenger (as myself and as Bieber Bot),
Twitter (public tweets, private tweets, and DMs),
HackerNews,
and it has limited support for Slack and Discord.
Ferdi, on the other hand, supports a much wider range of services, but doesn&amp;rsquo;t offer programmatic access;
I use Ferdi with
Facebook Messenger (as myself and as Bieber Bot),
Twitter (public tweets, private tweets, and DMs),
multiple Slacks,
Discord,
Gitter,
WhatsApp,
Telegram,
as well as for non-messaging services like Roam Research,
multiple spreadsheets,
supervisord,
and other adhoc use cases.&lt;/p&gt;
&lt;p&gt;I would like to extend Messager to have wider support,
particularly to improve support for Slack and Discord.
To do this, &lt;mark&gt;I&amp;rsquo;d love to automate Ferdi&lt;/mark&gt;.&lt;/p&gt;
&lt;h3 id=&#34;motivation-go-note-go---messager-bridge&#34;&gt;Motivation: Go Note Go - Messager Bridge&lt;/h3&gt;
&lt;p&gt;Why do I want to improve Messager &lt;em&gt;now&lt;/em&gt;? It&amp;rsquo;s because of 
&lt;a href=&#34;https://davidbieber.com/projects/go-note-go&#34;&gt;Go Note Go&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;m adding messaging support to Go Note Go. The main use case I&amp;rsquo;m targeting is this:&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;m drifting off to sleep and realize I want to tell someone something.
So I write in Go Note Go something along the lines of &amp;ldquo;Tell John Smith Hey John, I have this new idea for Go Note Go where you can send messages as your drifting off to sleep &amp;ndash; maybe I can tell you about it tomorrow&amp;rdquo;.&lt;/p&gt;
&lt;p&gt;When I wake up the following morning, Bieber Bot has messaged me with a link to a spreadsheet.
It has all the messages I drafted the previous night (they haven&amp;rsquo;t been sent yet).
There, I can clean them up for any typos and &amp;ldquo;approve&amp;rdquo; them (mark them as OK to send).
And once they&amp;rsquo;re approved, they&amp;rsquo;ll be sent automatically using Messager.&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s in support of this project that I&amp;rsquo;d love for Messager to support a wider variety of services.
Ideally the system will intelligently select the service to use to send the message based on the recipients.
It will include the service in the spreadsheet, so that I can adjust the service if needed before approving the message.&lt;/p&gt;
&lt;p&gt;So this is going to be a Go_Note_Go-Sheets-Messager-Bieber_Bot collab.&lt;/p&gt;
&lt;p&gt;tl;dr Go Note Go adds draft messages to a spreadsheet. Bieber Bot uses that spreadsheet to message me about new draft messages, and to message friends on my behalf with approved messages.&lt;/p&gt;
&lt;h3 id=&#34;motivation-going-beyond&#34;&gt;Motivation: Going beyond&lt;/h3&gt;
&lt;p&gt;For the Messager application described so far, pixel-space automation is not necessary.
All of the services I want to automate can be opened in the Browser,
and so existing Browser automation techniques are sufficient.
I would use Browserflow for this if it supported programmatic triggers, but it does not.
(Psst&amp;hellip; DK, can you add the ability to programmatically trigger a local flow please?)&lt;/p&gt;
&lt;p&gt;Given this, why is pixel-space automation interesting?
It&amp;rsquo;s because it would enable
(1) easier automation construction for the automations I&amp;rsquo;m interested in
and (2) it enables a much larger class of automations, and empowerment is key.

&lt;a href=&#34;https://davidbieber.com/snippets/2021-12-07-future-automation-software/&#34;&gt;See here for my dreams for the future of automation.&lt;/a&gt;&lt;/p&gt;
&lt;h3 id=&#34;ferdi-actions&#34;&gt;Ferdi Actions&lt;/h3&gt;
&lt;p&gt;The main actions I want for the Messager application are:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Ferdi: Navigating to different services&lt;/li&gt;
&lt;li&gt;Discord: Choosing a server, channel, or recipient&lt;/li&gt;
&lt;li&gt;Discord: Sending and receiving messages on that channel&lt;/li&gt;
&lt;li&gt;Slack: Choosing a channel or recipient&lt;/li&gt;
&lt;li&gt;Slack: Sending and receiving messages on that channel&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;the-challenge&#34;&gt;The Challenge&lt;/h3&gt;
&lt;h5 id=&#34;why-are-the-discord-and-slack-apis-not-sufficient&#34;&gt;Why are the Discord and Slack APIs not sufficient?&lt;/h5&gt;
&lt;p&gt;Both Discord and Slack have policies against using self-bots. Their APIs don&amp;rsquo;t allow you to programmatically control your own user account. So, controlling your account as a human would, through the provided chat client, is a natural way to approach the problem.&lt;/p&gt;
&lt;p&gt;The advantages of using Ferdi over the browser are: (1) it uses service hibernation, so you can skip loading the pages and logging in each time you start using a website, (2) maybe you can keep using the browser while Ferdi automates in the background.&lt;/p&gt;
&lt;p&gt;Each of these actions is doable using existing browser automation tools. Navigating to different services in the browser requires authentication though, if you&amp;rsquo;re not already logged in (which I would be in Ferdi). Perhaps with Browserflow&amp;rsquo;s cookie sharing feature, I can also already be logged in at the start of a Browserflow flow even on Cloud.&lt;/p&gt;
&lt;h3 id=&#34;current-status&#34;&gt;Current Status&lt;/h3&gt;
&lt;p&gt;I took a break in the middle of writing this flow and now I&amp;rsquo;ve implemented sending messages via Browserflow in both Slack and Discord.
I&amp;rsquo;ve also gone further toward the Go Note Go-Messager bridge,
implementing a few of the other steps.
Whenever I use &amp;ldquo;@Person&amp;rdquo; in Roam, Bieber Bot automatically copies the message into a spreadsheet.
The spreadsheet has an &amp;ldquo;Approval&amp;rdquo; column, where I can mark messages as OK to send.
Bieber Bot will then use Messager to send any approved messages.
Since Go Note Go sends it&amp;rsquo;s notes to Roam, this completes the circuit.&lt;/p&gt;
&lt;p&gt;I can now send messages from Go Note Go to any of Facebook Messenger, Twitter, Slack, and Discord.
I&amp;rsquo;m still excited about pixel-space automation, but I&amp;rsquo;ll have to save that excitement for a future snippet; for now, Browserflow was sufficient.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>The Future of Automation Software</title>
      <link>https://davidbieber.com/snippets/2021-12-07-future-automation-software/</link>
      <pubDate>Tue, 07 Dec 2021 00:00:00 +0000</pubDate>
      <guid>https://davidbieber.com/snippets/2021-12-07-future-automation-software/</guid>
      <description>&lt;p&gt;
&lt;a href=&#34;https://browserflow.app&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Browserflow&lt;/a&gt; is great.
It&amp;rsquo;s beyond great.
It&amp;rsquo;s one of my favorite tools, because it is so versatile and empowering.&lt;/p&gt;
&lt;p&gt;Nevertheless, there&amp;rsquo;s more that I want from my automation tools.
Here&amp;rsquo;s a summary of what I&amp;rsquo;d like:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;OS-level actions&lt;/li&gt;
&lt;li&gt;Per-application actions&lt;/li&gt;
&lt;li&gt;Per-website actions&lt;/li&gt;
&lt;li&gt;Computer vision guided actions&lt;/li&gt;
&lt;li&gt;Natural language action specification&lt;/li&gt;
&lt;li&gt;Automatic action discovery&lt;/li&gt;
&lt;li&gt;Automatic automation extraction&lt;/li&gt;
&lt;li&gt;User-triggered, event-triggered and time-triggered automations&lt;/li&gt;
&lt;li&gt;A great sharing experience&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;os-level-actions&#34;&gt;OS-level actions&lt;/h4&gt;
&lt;p&gt;Browserflow is (appropriately) limited in scope.
It allows automating the Browser, and that&amp;rsquo;s it.
I would like to be able to use a Browserflow-like system to automate the Browser as well as everything else on my computer.
In the idealized hypothetical future I&amp;rsquo;m constructing here, I don&amp;rsquo;t need to think about the boundaries between applications and operating system when I construct an automation.&lt;/p&gt;
&lt;p&gt;Example OS-level actions include launching applications, switching between open windows of different applications, closing applications, switching between Desktops, and resizing windows.&lt;/p&gt;
&lt;p&gt;Mac&amp;rsquo;s Automator software is a good example of an automation tool that supports OS-level actions, but (to my knowledge) it does not then also provide a good browser automation experience.&lt;/p&gt;
&lt;p&gt;An example automation that takes advantage of these actions is setting up a series of windows just the way I like them (today achievable with software like 
&lt;a href=&#34;https://manytricks.com/moom/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Moom&lt;/a&gt;).
Combined with per-application actions (next section), these actions allow for powerful multi-application automations.&lt;/p&gt;
&lt;h4 id=&#34;per-application-actions&#34;&gt;Per-application actions&lt;/h4&gt;
&lt;p&gt;The range of activities people perform on computers is extremely wide.
Each application has different actions that are possible to take in it.
I would like for automation software to reflect this.&lt;/p&gt;
&lt;p&gt;Photo editing applications can provide actions for photo editing,
word processing applications should have their own domain-specific actions,
and gaming and music applications should similarly provide their own.&lt;/p&gt;
&lt;p&gt;This is somewhat reflected in the state of things today in Automator.
For some software, there are actions available allowing programmatic control of the application.
Today, these actions must be provided by the application developer.&lt;/p&gt;
&lt;p&gt;We should go beyond this; ordinary users should be able to make actions for a piece of software and share them with other users of that software.
The actions provided by the application developer that Automator can access today are often insufficient.
But developing a new action does not need to be a difficult endeavor.&lt;/p&gt;
&lt;p&gt;An action developer should be able write a parameterized action that (1) verifies the application meets any preconditions necessary for performing the action, (2) uses menu items, buttons, the mouse and keyboard, and visual indicators (3) in order to perform a sequence of sub-actions in the application to achieve the action&amp;rsquo;s overall intended behavior.
Sharing these actions with others who might use them in broader automations should be possible on GitHub or through any other means (e.g. an actions repository or actions store, for example, either of which would allow browsing actions by application.)&lt;/p&gt;
&lt;p&gt;Critically, I would like these OS-level and application-level actions to be available in the same software as the browser-level and website-level actions that a tool like Browserflow provides.&lt;/p&gt;
&lt;p&gt;Much of my computer activity happens in the browser, text editor, and the terminal. If this trend away from desktop applications toward browser-usage is taking place for everyone, OS-level and application-level actions may be less important than what we discuss next: per-website actions, vision-based actions, and automatic action discovery.&lt;/p&gt;
&lt;h4 id=&#34;per-website-actions&#34;&gt;Per-website actions&lt;/h4&gt;
&lt;p&gt;Some applications, particularly browsers, do not have a clear fixed set of actions that make sense, because they can render many websites.
Each website has different things you can do on it.&lt;/p&gt;
&lt;p&gt;So, similar to the per-application actions proposed in the previous section,
I&amp;rsquo;d also like to call for per-website actions.
DK, consider this a Browserflow feature request.&lt;/p&gt;
&lt;p&gt;In Browserflow, a user can define a flow and call that flow from another flow.
This isn&amp;rsquo;t the most well-developed feature of Browserflow;
developing and debugging flows like this requires a lot of clicking around, and it&amp;rsquo;s hard to see what you&amp;rsquo;re doing during development.
Nevertheless, it&amp;rsquo;s a powerful feature that is the seed of per-website actions.&lt;/p&gt;
&lt;p&gt;That you can use a flow as an action in Browserflow means you can define flows
for individual activities you might perform on a website, and use them repeatedly in many different flows pertaining to that website.
Browserflow also allows sharing flows, but there&amp;rsquo;s no central repository of them yet, so it is taking solid but small steps toward the dream of user-friendly discoverable per-website actions.&lt;/p&gt;
&lt;p&gt;Since every website has different actions to perform on it, and website authors do not provide these actions,
it is somewhat surprising that browser automation leads the automation scene in terms of its capabilities. The saving grace here is that websites conform to standards and expose structure that automation software can take advantage of, which desktop applications do not provide. Browser automation software uses CSS and XPATH selectors to take advantage of this uniformity to provide a decent automation experience.
For desktop software, or for websites that are not built in a tool-friendly manner, we turn to our next feature-request for automation software, vision-guided actions.&lt;/p&gt;
&lt;h4 id=&#34;computer-vision-guided-actions&#34;&gt;Computer vision guided actions&lt;/h4&gt;
&lt;p&gt;All the actions in automation software today operate on clearly defined data structures, but there is so much more that&amp;rsquo;s possible using computer vision.
Actions that work on websites rely on CSS or XPATH queries to find the appropriate part of the page to manipulate.
Computer vision based actions can work in places where there is no DOM, and hence no notion of CSS or XPATH selectors.&lt;/p&gt;
&lt;p&gt;An example of a computer vision based action is &amp;ldquo;Find the text X&amp;rdquo;. Here, X is a parameter. When run, the action identifies the location of the screen containing the text X. The beauty is that X doesn&amp;rsquo;t need to be on a webpage or in a text field. Even if X is stylized, part of a pdf, or part of an image, the action will still work. This action can be followed up with &amp;ldquo;Click&amp;rdquo; or &amp;ldquo;Screenshot&amp;rdquo; actions, that use the location found from the &amp;ldquo;Find the text X&amp;rdquo; action as a parameter.&lt;/p&gt;
&lt;p&gt;Another example of a computer vision based action is &amp;ldquo;Find a region visually similar to X&amp;rdquo;. This action is parameterized by an image, and it finds the location of that image (or similar) on the screen. This might be useful for automating a game with a custom graphic that you have to interact with; it doesn&amp;rsquo;t matter if that game doesn&amp;rsquo;t provide any semantic elements like buttons or a DOM, the computer vision actions will still admit automation.&lt;/p&gt;
&lt;p&gt;I found computer vision guided actions useful when building 
&lt;a href=&#34;https://github.com/dbieber/ScrabbleBot&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Scrab Blebot&lt;/a&gt;, a Scrabble-playing bot that could play Words With Friends on Facebook.
The bot looked for regions of the screen visually similar to an image of a Scrabble tile with a letter on it in order to figure out where to click and drag.
I had to build my own one-off actions for this project though; there was no automation software with vision-based actions available for me to use when developing this project ten (!) years ago.&lt;/p&gt;
&lt;h4 id=&#34;natural-language-action-specification&#34;&gt;Natural language action specification&lt;/h4&gt;
&lt;p&gt;&amp;ldquo;Click the submit button.&amp;rdquo;&lt;/p&gt;
&lt;p&gt;&amp;ldquo;Copy the first paragraph.&amp;rdquo;&lt;/p&gt;
&lt;p&gt;So far we have only spoken about allowing developers to define actions. In the next section we will move on to automatic action discovery &amp;ndash; where an action is detected and defined automatically by an algorithm, rather than being defined by a human.
Natural language action specification fits nicely in between these two categories.
The idea here is that we can map human natural language to an action.&lt;/p&gt;
&lt;p&gt;If the user says &amp;ldquo;Click the submit button&amp;rdquo;, we can use machine learning to infer that this translates to a single action &amp;ldquo;Click&amp;rdquo; parameterized by the selector &amp;ldquo;.submit&amp;rdquo; (or whatever the appropriate selector is for the current page).&lt;/p&gt;
&lt;p&gt;If the user says &amp;ldquo;Copy the first paragraph&amp;rdquo;, again machine learning can translate this into one or more actions that achieves the task.
Large language models will be instrumental in making this feature production quality. See for example the 
&lt;a href=&#34;https://www.youtube.com/watch?v=SGUCcjHTmGY&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Codex demo&lt;/a&gt; for a taste of the capabilities of large language models in this domain.&lt;/p&gt;
&lt;h4 id=&#34;automatic-action-discovery&#34;&gt;Automatic action discovery&lt;/h4&gt;
&lt;p&gt;We next move on to a research-level feature request: automatic action discovery.
There are billions of websites and software applications, each with its own user interface and its own set of possible actions.
It&amp;rsquo;s unreasonable to expect that a developer will construct actions for each and every one of these, but that doesn&amp;rsquo;t mean we can&amp;rsquo;t use machine learning to detect actions automatically.&lt;/p&gt;
&lt;p&gt;There are two types of signal that are useful for automatically detecting actions: (1) similarity in user interface to known actions, and (2) observing user behavior.&lt;/p&gt;
&lt;p&gt;(1) Though each website and application has its own UI, there are common patterns. Taking advantage of these common patterns, an algorithm might be able to discern that a website or application provides certain actions simply from its UI elements and arrangement.&lt;/p&gt;
&lt;p&gt;(2) By observing user behavior on a website or application (and comparing it with behaviors exhibited previously), an algorithm might be able to detect actions available on that website or application even when method (1) falls short (or in combination with method (1)).&lt;/p&gt;
&lt;p&gt;Critical to doing automatic action discovery well is figuring out how to parameterize the discovered actions.
In many cases this is easy; when filling out a form on a website, the text typed is the parameter, while the location in the form is a core part of the action.
In other cases, it&amp;rsquo;s less clear cut; in a shell, typing a command is part of an action, while typing an argument to the command is a parameter, but these are comprised of similar low-level actions (typing characters).
This is an interesting research challenge to get right.&lt;/p&gt;
&lt;h4 id=&#34;automatic-automation-extraction&#34;&gt;Automatic automation extraction&lt;/h4&gt;
&lt;p&gt;The pièce de résistance of future automation software is automatic automation extraction.
Software will one day automatically notice when something you&amp;rsquo;re doing can be automated, and it will offer to automate it for you.
It might notice this because (1) you&amp;rsquo;re engaging in a repeated behavior.
Or it might notice this because (2) you&amp;rsquo;re engaging in a behavior similar to one it&amp;rsquo;s seen before (e.g. from data collected from other users earlier).&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s important that anyone working on automatic automation extraction respect user privacy.
The data that would be most useful for this type of project (broad computer usage data) is extremely sensitive.
It is an interesting research direction to work toward this goal of automatic automation extraction in a way that consumes little data, and which can be deployed in a privacy preserving manner.&lt;/p&gt;
&lt;h4 id=&#34;user-triggered-event-triggered-and-time-triggered-automations&#34;&gt;User-triggered, event-triggered and time-triggered automations&lt;/h4&gt;
&lt;p&gt;I conclude with a more modest request than the previous two machine learning based feature requests: triggers.&lt;/p&gt;
&lt;p&gt;As I see it, a good trigger experience is what makes or breaks the value of automation software. This is because the triggers are the largest potential source of friction for a user of automations, outside of constructing the automation to begin with.&lt;/p&gt;
&lt;p&gt;For user-triggered automations (automations instigated by a user),
I really liked the typeahead UI that Browserflow initially used.
I remain hopeful that DK will bring that back.
Keyboard shortcuts are the other clear contender for a good triggering experience.&lt;/p&gt;
&lt;p&gt;Event-triggered automations are also extremely useful.
In my own day-to-day, I use email triggered automations (for handling emails from banks), and chat-triggered automations for all sorts of things.
If-this-than-that is probably an excellent source of inspiration for other events. You can also see 
&lt;a href=&#34;https://davidbieber.com/snippets/2020-02-04-bieber-bot-capabilities/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;this list of Bieber Bot&amp;rsquo;s capabilities&lt;/a&gt; which breaks the capabilities down by whether they&amp;rsquo;re timer-triggered, chat-triggered, or credit-card-swipe-triggered.&lt;/p&gt;
&lt;p&gt;Time-triggered automations can be broken down further into one-off automations (e.g. &amp;ldquo;send this email tomorrow morning&amp;rdquo;) and recurring ones (&amp;ldquo;every morning, email me a digest with the news, weather, and a cat video to watch&amp;rdquo;).&lt;/p&gt;
&lt;p&gt;Triggers don&amp;rsquo;t need to be provided directly by the same software that allows creating automations, but it is sensible to bundle these two things together, since automations are a common thing to want to trigger. Separate trigger software and automation software is in many ways actually desirable, but it is critical that the experience of setting up triggers for an automation be clean and user friendly.&lt;/p&gt;
&lt;h4 id=&#34;a-great-sharing-experience&#34;&gt;A great sharing experience&lt;/h4&gt;
&lt;p&gt;Finally, automation is a superpower, and so I want to be able to share it with others.
If I write a note-taking automation, I want my fellow note-takers to be able to use it.
If someone writes a Farmville automation tool, other Farmville players should be able to use it too.&lt;/p&gt;
&lt;p&gt;However, sharing comes with concerns: you don&amp;rsquo;t want to give untrustworthy strangers unfettered access to your machine. Arbitrary code execution is dangerous.&lt;/p&gt;
&lt;p&gt;So, my ideal sharing experience is a hybrid of &amp;ldquo;app store&amp;rdquo; and &amp;ldquo;GitHub&amp;rdquo;.
A curated collection of automations that are audited and trustworthy, easy to search, and easy to discover would be very welcome. If automations from this collection were automatically surfaced when I was browsing on a website that had such an automation built for it, I would be delighted.&lt;/p&gt;
&lt;p&gt;Then, for automations that haven&amp;rsquo;t gone through any vetting process, it should still be easy to share. It should be possible to host an automation on GitHub or to send an automation to a friend without ever needing a central body to vet the automation.&lt;/p&gt;
&lt;p&gt;By supporting both of these sharing models, we can ensure a healthy ecosystem of automations
useful both for programmers and automation builders, and for people who simply want to experience the joy of computing using the automations of others.&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;Interested in working on any of these aspects of automation software? Get in touch. I&amp;rsquo;m always eager to discuss.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Machine Learning and Automation Ideas for Note-taking</title>
      <link>https://davidbieber.com/snippets/2021-10-28-ml-and-automation-for-note-taking/</link>
      <pubDate>Thu, 28 Oct 2021 00:00:00 +0000</pubDate>
      <guid>https://davidbieber.com/snippets/2021-10-28-ml-and-automation-for-note-taking/</guid>
      <description>&lt;p&gt;Let&amp;rsquo;s consider machine learning first, and then automation. For each we brainstorm the potential value for note-taking.&lt;/p&gt;
&lt;h3 id=&#34;the-value-of-markmachine-learningmark-for-note-taking&#34;&gt;The Value of &lt;mark&gt;Machine Learning&lt;/mark&gt; for Note-Taking&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Automatic &lt;strong&gt;transcription&lt;/strong&gt; of audio notes
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Speaker identification&lt;/strong&gt; during meetings or conversations&lt;/li&gt;
&lt;li&gt;Resurfacing of action items, surfacing relevant information, and performing actions (e.g running a google search or sending a message) in response to audio cues during meetings or conversations&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Automatic &lt;strong&gt;categorization&lt;/strong&gt; of notes&lt;/li&gt;
&lt;li&gt;Automatic &lt;strong&gt;categorization of spaced repetition&lt;/strong&gt; flash cards&lt;/li&gt;
&lt;li&gt;Automatic &lt;strong&gt;context-filling&lt;/strong&gt; of spaced repetition flash cards
&lt;ul&gt;
&lt;li&gt;e.g. highlight a phrase to create a flash card; the necessary context is pulled in from surrounding paragraphs to make a coherent standalone flash card.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Automatic &lt;strong&gt;connections&lt;/strong&gt; and graph construction:
&lt;ul&gt;
&lt;li&gt;Textual elements:
&lt;ul&gt;
&lt;li&gt;Entity extraction from notes (&amp;ldquo;implicit nodes&amp;rdquo;, e.g. &amp;ldquo;Bank of America&amp;rdquo;)&lt;/li&gt;
&lt;li&gt;Attribute extraction from notes (e.g. &amp;ldquo;incredible presentation by Pierre-Antoine&amp;rdquo; gets tagged as incredible or wow (the canonical form).)&lt;/li&gt;
&lt;li&gt;Relationship extraction (e.g. &amp;ldquo;Diamond Age by Neal Stephenson&amp;rdquo; -&amp;gt; creates an &amp;ldquo;author of&amp;rdquo; relationship)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Background knowledge elements:
&lt;ul&gt;
&lt;li&gt;e.g. knowing that Diamond Age is a book&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Writing prompt generator / &lt;strong&gt;Writing assistant&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Overlap detection&lt;/strong&gt; between people&amp;rsquo;s graphs
&lt;ul&gt;
&lt;li&gt;The Go Note Go &amp;ldquo;clink&amp;rdquo; scenario&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Autocomplete&lt;/strong&gt; (e.g. gmail tab completion)&lt;/li&gt;
&lt;li&gt;Improved &lt;strong&gt;spaced repetition algorithms&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Mistake detection / &lt;strong&gt;fact checking&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Summarization&lt;/strong&gt; of notes&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Highlight extraction&lt;/strong&gt; from notes&lt;/li&gt;
&lt;li&gt;Suggesting &lt;strong&gt;new ideas&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Suggesting &lt;strong&gt;new online resources&lt;/strong&gt; to read / explore
&lt;ul&gt;
&lt;li&gt;Incl. articles, papers, YouTube videos, Suggesting &lt;strong&gt;people to reach out to&lt;/strong&gt; (e.g. because of their blog or Twitter or other things they&amp;rsquo;re written)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Semantic search&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Conversational chat bots&lt;/strong&gt; for exploring the knowledge in a notebase&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&#34;the-value-of-markautomationmark-for-note-taking&#34;&gt;The Value of &lt;mark&gt;Automation&lt;/mark&gt; for Note-Taking&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Share notes&lt;/strong&gt; with people via their preferred messaging platform&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Snooze notes&lt;/strong&gt; and ideas so you review them later&lt;/li&gt;
&lt;li&gt;Set pomodoros, alarms, and reminders to &lt;strong&gt;stay focused&lt;/strong&gt; and &lt;strong&gt;stay on task&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;Note-taking &lt;strong&gt;via highlights&lt;/strong&gt; (e.g. with Browserflow)&lt;/li&gt;
&lt;li&gt;Note-taking &lt;strong&gt;via screenshots&lt;/strong&gt; (e.g. from YouTube)&lt;/li&gt;
&lt;li&gt;Automatic creation of &lt;strong&gt;spaced repetition from highlights&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Bulk refactors&lt;/strong&gt; of note-taking&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Pulling in context&lt;/strong&gt; from other sources (e.g. Warmly pulls LinkedIn info into Calendar, notes could pull info from wikipedia)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Sync notes&lt;/strong&gt; between other sources and your notebase
&lt;ul&gt;
&lt;li&gt;Other people&amp;rsquo;s notes&lt;/li&gt;
&lt;li&gt;Your email client, calendar, TODO app, spaced repetition app, GitHub issues, other messaging services, etc&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Publishing&lt;/strong&gt; of notes to a webpage (either publicly or privately), or to social media&lt;/li&gt;
&lt;li&gt;New &lt;strong&gt;data entry&lt;/strong&gt; mechanisms: &lt;strong&gt;Go Note Go&lt;/strong&gt;, terminal, email, text, browsing history, location history, terminal history, IoT devices, etc&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Spaced repetition&lt;/strong&gt; for studying&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Inactivity reminders&lt;/strong&gt; (e.g. &amp;ldquo;it&amp;rsquo;s been three months since you&amp;rsquo;ve done a music activity&amp;rdquo;, or &amp;ldquo;it&amp;rsquo;s been over 6 months since you&amp;rsquo;ve spoken with David Dohan&amp;rdquo;, or &amp;ldquo;it&amp;rsquo;s been over a year since you&amp;rsquo;ve written about microbiology.&amp;quot;)&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Writing a Mail Merge in Google Apps Script</title>
      <link>https://davidbieber.com/post/2018-10-21-apps-script-mail-merge/</link>
      <pubDate>Sun, 21 Oct 2018 00:00:00 +0000</pubDate>
      <guid>https://davidbieber.com/post/2018-10-21-apps-script-mail-merge/</guid>
      <description>&lt;p&gt;Google Apps Script is endlessly useful; in this post you will learn how to write a mail merge with Google Apps Script. It&amp;rsquo;s less than 30 lines of code! You can use this technique to send personalized emails individually to many recipients. In the second part of this post, you will learn how to schedule these emails to send in the future.&lt;/p&gt;
&lt;h2 id=&#34;part-1-writing-a-mail-merge&#34;&gt;Part 1: Writing a Mail Merge&lt;/h2&gt;
&lt;p&gt;A &lt;em&gt;mail merge&lt;/em&gt; is a program that sends an email to many recipients, automatically filling in the contents of the email according to a template. It&amp;rsquo;s like a form letter. Each recipient receives a personalized copy of the email.&lt;/p&gt;
&lt;p&gt;In this section we use Google Apps Script to create a mail merge that sends personalized &amp;ldquo;Happy Birthday&amp;rdquo; messages to a group of our friends. This will involve writing a template email, creating a spreadsheet, and writing a small amount of JavaScript code. With practice, you can perform tasks like this in well under an hour.&lt;/p&gt;
&lt;p&gt;First, we draft the email in Gmail. We&amp;rsquo;ll use angle brackets for the parts of the message we want to replace with data from our spreadsheet.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-md&#34;&gt;Subject:
  Happiest Birthday!

Body:
  Dear &amp;lt;name&amp;gt;,

  Happy birthday! I think you, &amp;lt;name&amp;gt;, personally are awesome.
  You may be getting older, but you&#39;re still the coolest person I know.
  What are you now, &amp;lt;age&amp;gt;? Wow.

  Party on!
  David
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Next, we create a Google Spreadsheet (
&lt;a href=&#34;https://sheets.google.com&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;sheets.google.com&lt;/a&gt;) with three columns like this:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-md&#34;&gt;Name  Email  Age  
...   ...    ...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;(To add yourself to my spreadsheet and actually receive a happy birthday email on your alleged birthday, just 
&lt;a href=&#34;https://goo.gl/forms/qEy8f5CQ8itVVFoe2&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;fill out this form&lt;/a&gt;.)&lt;/p&gt;
&lt;p&gt;Inside your spreadsheet, choose &lt;em&gt;Tools &amp;gt; Script Editor&lt;/em&gt;. This creates a new Apps Script associated with your spreadsheet.&lt;/p&gt;
&lt;p&gt;Now it&amp;rsquo;s time to write some JavaScript. We&amp;rsquo;re going to write a function to perform the mail merge.
We&amp;rsquo;ll call it &lt;code&gt;performMailMerge&lt;/code&gt; and it won&amp;rsquo;t have any parameters, e.g.:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;function performMailMerge() {}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;It will use the built in SpreadsheetApp library to access the spreadsheet, the SpreadsheetDB library to perform basic data lookup operations on the spreadsheet, and the built in GmailApp library to look up drafts and send emails.&lt;/p&gt;
&lt;p&gt;SpreadsheetDB is a small library (a collection of useful functions) that allows us to quickly process rows in a spreadsheet, referencing columns by their header names. Choose one of the two options below for using SpreadsheetDB.&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;To use the library SpreadsheetDB, choose Resources &amp;gt; Libraries &amp;gt; Add a library and enter &lt;code&gt;193p7IxBukPVkoxwMH8UDcdkYJiNCDWSylMA_htgliEPxjjqixhzKt_2g&lt;/code&gt;. This is the ID of the SpreadsheetDB library. Select the latest version from the version dropdown menu. It should say &amp;ldquo;SpreadsheetDB&amp;rdquo; if you&amp;rsquo;ve done it right. This will allow you to use functions from the SpreadsheetDB library in your project.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;To use SpreadsheetDB from source, create a new file in your project and name it &lt;code&gt;spreadsheet.gs&lt;/code&gt; (the name is not important). Copy and paste in the source of SpreadsheetDB from the 
&lt;a href=&#34;https://gist.github.com/dbieber/471a3103adb727d6985892338de00aea&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Gist here&lt;/a&gt;. If you choose to copy and paste the source into your project, then you must omit the prefix &amp;ldquo;SpreadsheetDB.&amp;rdquo; from your calls to the SpreadsheetDB functions in the following code. E.g. &lt;code&gt;SpreadsheetDB.getColumnIndexesFromSheet&lt;/code&gt; would become just &lt;code&gt;getColumnIndexesFromSheet&lt;/code&gt;.&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Now that you&amp;rsquo;re set up with SpreadsheetDB, I&amp;rsquo;ll start by showing you the full program, then I&amp;rsquo;ll explain what each line does.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;function performMailMerge() {
  var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = spreadsheet.getSheetByName(&amp;quot;Sheet 1&amp;quot;);
  var indexes = SpreadsheetDB.getColumnIndexesFromSheet(sheet);
  var subject = &amp;quot;Happiest Birthday!&amp;quot;;
  var draftMessage = getDraftMessageBySubject(subject);
  var templateBody = draftMessage.getPlainBody();
  SpreadsheetDB.forEachRow(sheet, function(row) {
    var name = row[indexes[&amp;quot;Name&amp;quot;]];
    var email = row[indexes[&amp;quot;Email&amp;quot;]];
    var age = row[indexes[&amp;quot;Age&amp;quot;]];
    
    var body = templateBody.replace(/&amp;lt;name&amp;gt;/g, name).replace(/&amp;lt;age&amp;gt;/g, age);
    GmailApp.sendEmail(email, subject, body);
  });
}

function getDraftMessageBySubject(subject) {
  var draftMessages = GmailApp.getDraftMessages();
  for (var i = 0; i &amp;lt; draftMessages.length; i++) {
    var draftMessage = draftMessages[i];
    if (draftMessage.getSubject() == subject) {
      return draftMessage;
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The documentation for the built in libraries is very good. You can find the documentation for 
&lt;a href=&#34;https://developers.google.com/apps-script/reference/spreadsheet/spreadsheet-app&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;SpreadsheetApp&lt;/a&gt; here and for 
&lt;a href=&#34;https://developers.google.com/apps-script/reference/gmail/gmail-app&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;GmailApp&lt;/a&gt; here.&lt;/p&gt;
&lt;p&gt;Let’s look at the pieces of this function individually:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
var sheet = spreadsheet.getSheetByName(&amp;quot;Sheet 1&amp;quot;);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This gives us a 
&lt;a href=&#34;https://developers.google.com/apps-script/reference/spreadsheet/sheet&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Sheet&lt;/a&gt; object that we can use to access and edit the main sheet of our spreadsheet.&lt;/p&gt;
&lt;p&gt;The function call SpreadsheetDB.getColumnIndexesFromSheet(sheet) gives us back a mapping from column name to index. This is useful for accessing elements of a row by name later on. In our case, the result of getColumnIndexesFromSheet is the following mapping: &lt;code&gt;{Name: 0, Email: 1, Age: 2}&lt;/code&gt;. This means that Name is column index 0, Email is column index 1, and Age is column index 2. We’re counting columns starting with zero. Perfect!&lt;/p&gt;
&lt;p&gt;The call to &lt;code&gt;getDraftMessageBySubject&lt;/code&gt; gets a draft from our Gmail drafts that we’ll use later to send the emails to our friends.&lt;/p&gt;
&lt;p&gt;We use the &lt;code&gt;SpreadsheetDB.forEachRow&lt;/code&gt; function to perform an action for each row in the spreadsheet except the headers. We pass a function with no name (an &amp;ldquo;anonymous function&amp;rdquo;) to SpreadsheetDB, and SpreadsheetDB will call that function once per non-header row of our spreadsheet.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;    var name = row[indexes[&amp;quot;Name&amp;quot;]];
    var email = row[indexes[&amp;quot;Email&amp;quot;]];
    var age = row[indexes[&amp;quot;Age&amp;quot;]];
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The input to our anonymous function, row, is an array with the contents of the row currently being processed. From earlier, indexes[&amp;ldquo;Name&amp;rdquo;] is 0, indexes[&amp;ldquo;Email&amp;rdquo;] is 1, and indexes[&amp;ldquo;Age&amp;rdquo;] is 2. We can use this to get the name, email, and age of one of our friends from the spreadsheet.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;var body = templateBody.replace(/&amp;lt;name&amp;gt;/g, name).replace(/&amp;lt;age&amp;gt;/g, age);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This is where the textual replacement actually happens. &lt;code&gt;&amp;lt;name&amp;gt;&lt;/code&gt; is replaced with your friend&amp;rsquo;s name. &lt;code&gt;&amp;lt;age&amp;gt;&lt;/code&gt; is replaced with your friend&amp;rsquo;s age. The &amp;lsquo;g&amp;rsquo; indicates that a &amp;ldquo;global&amp;rdquo; replacement should be performed, so every time the string &lt;code&gt;&amp;lt;name&amp;gt;&lt;/code&gt; appears it will be replaced by the name of your friend from the spreadsheet. Without the &amp;lsquo;g&amp;rsquo;, only the first occurence of &lt;code&gt;&amp;lt;name&amp;gt;&lt;/code&gt; would be replaced.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;GmailApp.sendMail(email, subject, body);
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Last, this line sends the email!&lt;/p&gt;
&lt;p&gt;Since this is JavaScript, you can comment out lines by putting &lt;code&gt;//&lt;/code&gt; at the start of the line. Everything occuring after &lt;code&gt;//&lt;/code&gt; on the line will have no affect.&lt;/p&gt;
&lt;p&gt;I recommend commenting out the GmailApp.sendMail line before running this for the first time to so that you don&amp;rsquo;t accidently email people incorrectly.&lt;/p&gt;
&lt;p&gt;Add the line &lt;code&gt;Logger.log(&amp;quot;To: &amp;quot; + email); Logger.log(&amp;quot;Subj: &amp;quot; + subject); Logger.log(&amp;quot;Body: &amp;quot; + body);&lt;/code&gt; in place of the GmailApp.sendMail line until you&amp;rsquo;re convinced that the correct emails are going to be sent to the correct people. Only once you are sure it&amp;rsquo;s working as intended, uncomment the GmailApp.sendMail line so it actually sends the emails.&lt;/p&gt;
&lt;p&gt;To run the performMailMerge function, choose performMailMerge from the dropdown and click the run (right-arrow) button.
To see your logs (the inputs to the Logger.log function calls), choose &amp;ldquo;View &amp;gt; Logs&amp;rdquo; or press ctrl-Enter or cmd-Enter.&lt;/p&gt;
&lt;img src=&#34;https://66.media.tumblr.com/da2acd06f66fb2c9b6f6e68f046029de/tumblr_pgyx7hQlOL1rfccnto1_1280.png&#34; alt=&#34;Apps Script menu bar: Run button&#34; style=&#34;width:700px;&#34;&gt;
&lt;p&gt;That&amp;rsquo;s it. When you run performMailMerge, the emails will be sent with the values from the spreadsheet substituted for the &amp;ldquo;&lt;name&gt;&amp;rdquo; and &amp;ldquo;&lt;age&gt;&amp;rdquo; placeholders in the draft. Once you&amp;rsquo;ve got the hang of this, let&amp;rsquo;s add a few finishing touches before moving on to scheduling emails to be sent in the future.&lt;/p&gt;
&lt;h3 id=&#34;finishing-touches&#34;&gt;Finishing Touches&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;Finishing touch 1:&lt;/em&gt; Adding a &amp;ldquo;Status&amp;rdquo; column to avoid emailing people twice.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-md&#34;&gt;Name  Email  Age  Status
...   ...    ...  ...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Let&amp;rsquo;s add some finishing touches. Add to your spreadsheet a new column &amp;ldquo;Status&amp;rdquo;. When an email sends successfully, we&amp;rsquo;ll set the status of the row to &amp;ldquo;Done&amp;rdquo;. If the status of a row is already &amp;ldquo;Done&amp;rdquo;, we&amp;rsquo;ll skip that row. The updated code is shown here:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;function performMailMerge() {
  var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = spreadsheet.getSheetByName(&amp;quot;Sheet 1&amp;quot;);
  var indexes = SpreadsheetDB.getColumnIndexesFromSheet(sheet);
  var subject = &amp;quot;Happiest Birthday!&amp;quot;;
  var draftMessage = getDraftMessageBySubject(subject);
  var templateBody = draftMessage.getPlainBody();
  SpreadsheetDB.forEachRow(sheet, function(row) {
    var name = row[indexes[&amp;quot;Name&amp;quot;]];
    var email = row[indexes[&amp;quot;Email&amp;quot;]];
    var age = row[indexes[&amp;quot;Age&amp;quot;]];
    var status = row[indexes[&amp;quot;Status&amp;quot;]];
    
    if (status == &amp;quot;Done&amp;quot;) {
      return;
    }
    
    var body = templateBody.replace(/&amp;lt;name&amp;gt;/g, name).replace(/&amp;lt;age&amp;gt;/g, age);
    GmailApp.sendEmail(email, subject, body);
    
    row[indexes[&amp;quot;Status&amp;quot;]] = &amp;quot;Done&amp;quot;;
    return row;
  });
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;In order to make this change, we just check the value of &lt;code&gt;row[indexes[&amp;quot;Status&amp;quot;]]&lt;/code&gt;, and use a return statement to skip the row if the status is &amp;ldquo;Done&amp;rdquo;.
In order to update the row, we modify the &lt;code&gt;row&lt;/code&gt; array and return it and SpreadsheetDB takes care of updating the underlying spreadsheet.&lt;/p&gt;
&lt;p&gt;With this change in place, we can now add new recipients to our spreadsheet even after having run the performMailMerge function, and if we run performMailMerge again we won&amp;rsquo;t email anyone who has already received an email.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Finishing touch 2:&lt;/em&gt; Adding a menu item that triggers our function.&lt;/p&gt;
&lt;p&gt;When we created our Apps Script, it was automatically associated with our spreadsheet. If we add a function named &lt;code&gt;onOpen()&lt;/code&gt; to our Apps Script, it will automatically get run when the associated spreadsheet is opened. We can add a menu item to our spreadsheet by writing an onOpen function like this one:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;function onOpen() {
  SpreadsheetApp.getUi()
  .createMenu(&#39;Mail Merge&#39;)
  .addItem(&#39;Send Emails&#39;, &#39;performMailMerge&#39;)
  .addToUi();
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Go ahead and refresh your spreadsheet. You should now see a menu called &amp;ldquo;Mail Merge&amp;rdquo; with a menu item &amp;ldquo;Send Emails&amp;rdquo;. Selecting &amp;ldquo;Send Emails&amp;rdquo; will cause your performMailMerge function to be run.&lt;/p&gt;
&lt;img src=&#34;https://66.media.tumblr.com/bba93c6c694c1ed6196e86baa1307648/tumblr_pgyxyq8CVX1rfccnto1_1280.png&#34; alt=&#34;Mail merge custom menu bar&#34; style=&#34;width:700px;&#34;&gt;
&lt;h2 id=&#34;part-2-scheduling-emails-for-the-future&#34;&gt;Part 2: Scheduling Emails for the Future&lt;/h2&gt;
&lt;p&gt;In Part 1 we wrote a mail merge function that emails our friends &amp;ldquo;personalized&amp;rdquo; Happy Birthday messages when we run performMailMerge. But why would we want to say happy birthday to all our friends at once? That&amp;rsquo;s silly, it makes much more sense to send them a happy birthday message &lt;em&gt;on their birthday&lt;/em&gt;. In this section, we&amp;rsquo;ll modify our mail merge to send emails only on the birthday of the recipient.&lt;/p&gt;
&lt;p&gt;To start, let&amp;rsquo;s add a new &amp;ldquo;Birthday&amp;rdquo; column to our spreadsheet.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-md&#34;&gt;Name  Email  Age   Birthday  Status
...   ...    ...   ...       ...
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;We&amp;rsquo;re going to use the moment.js library for working with dates. Create a new file (&lt;em&gt;File &amp;gt; New &amp;gt; Script File&lt;/em&gt;) in your Apps Script project. Call it moment.gs, or anything else, and paste in the contents of the moment.js library. You can copy and paste moment.js from 
&lt;a href=&#34;https://momentjs.com/downloads/moment.js&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;here&lt;/a&gt;. Note: Be sure to use the non-minified version of moment.js; if you try using the minified version you will likely have trouble pasting the library into your Apps Script project.&lt;/p&gt;
&lt;p&gt;Now that we have moment.js, we can get the date of our friends birthday like this:
&lt;code&gt;moment(row[indexes[&amp;quot;Birthday&amp;quot;]])&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;We can then write the function isTodaysDate like this. This will check that the month and day of the given date are today&amp;rsquo;s month and day, irrespective of what year the given date has.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;function isTodaysDate(date) {
  var now = moment();
  return now.isSame(date.year(now.year()), &amp;quot;day&amp;quot;);
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Putting it all together, we have this updated version of performMailMerge that will only send the email if the current date matches the birthday of the recipient.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-javascript&#34;&gt;function isTodaysDate(date) {
  var now = moment();
  return now.isSame(date.year(now.year()), &amp;quot;day&amp;quot;);
}

function performMailMerge() {
  var spreadsheet = SpreadsheetApp.getActiveSpreadsheet();
  var sheet = spreadsheet.getSheetByName(&amp;quot;Sheet 1&amp;quot;);
  var indexes = SpreadsheetDB.getColumnIndexesFromSheet(sheet);
  var subject = &amp;quot;Happiest Birthday!&amp;quot;;
  var draftMessage = getDraftMessageBySubject(subject);
  var templateBody = draftMessage.getPlainBody();
  SpreadsheetDB.forEachRow(sheet, function(row) {
    var name = row[indexes[&amp;quot;Name&amp;quot;]];
    var email = row[indexes[&amp;quot;Email&amp;quot;]];
    var age = row[indexes[&amp;quot;Age&amp;quot;]];
    var status = row[indexes[&amp;quot;Status&amp;quot;]];
    var birthday = moment(row[indexes[&amp;quot;Birthday&amp;quot;]]);
    
    if (status == &amp;quot;Done&amp;quot;) {
      return;
    }
    if (!isTodaysDate(birthday)) {
      return;
    }
    
    var body = templateBody.replace(/&amp;lt;name&amp;gt;/g, name).replace(/&amp;lt;age&amp;gt;/g, age);
    GmailApp.sendEmail(email, subject, body);
    
    row[indexes[&amp;quot;Status&amp;quot;]] = &amp;quot;Done&amp;quot;;
    return row;
  });
}

function getDraftMessageBySubject(subject) {
  var draftMessages = GmailApp.getDraftMessages();
  for (var i = 0; i &amp;lt; draftMessages.length; i++) {
    var draftMessage = draftMessages[i];
    if (draftMessage.getSubject() == subject) {
      return draftMessage;
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Now the only step remaining is to make this performMailMerge function run every day. To do this, click the &amp;ldquo;Triggers&amp;rdquo; button in the toolbar (the clock icon). Create a new time-based trigger, and set it up so that it runs Daily (you get to choose when each day it will run). Configure it to run the performMailMerge each day at a time of your choice.&lt;/p&gt;
&lt;img src=&#34;https://66.media.tumblr.com/587d3371fc52f0ae50434a52337dbdfc/tumblr_pgyxa5usTC1rfccnto1_1280.png&#34; alt=&#34;Apps Script menu bar: Set a trigger&#34; style=&#34;width:700px;&#34;&gt;
&lt;p&gt;&lt;em&gt;Viola!&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;You now have a mail merge that&amp;rsquo;s running daily automatically, sending your friends Happy Birthday messages on their birthdays. Aren&amp;rsquo;t you a good friend?&lt;/p&gt;
&lt;p&gt;While sending birthday emails automatically is somewhat impersonal, the techniques used here are broadly applicable. With Apps Script, you can send yourself reminders, monitor your Calendar events, track your finances, and more. It&amp;rsquo;s a super useful and super friendly set of APIs, and this automated birthday emailer just scratches the surface of what Apps Script makes possible.&lt;/p&gt;
&lt;h2 id=&#34;wrap-up&#34;&gt;Wrap up&lt;/h2&gt;
&lt;p&gt;You&amp;rsquo;ve now learned how to program a mail merge function that uses a spreadsheet as input. You can use a template to send multiple recipients personalized emails. You can schedule these emails to send in the future.&lt;/p&gt;
&lt;p&gt;You now have a great power, and with it comes great responsibility. Don&amp;rsquo;t use this for spam. Be kind and courteous to your fellow citizens of the internet. If you find this useful, do let me know what you use it for (I&amp;rsquo;m 
&lt;a href=&#34;https://twitter.com/Bieber&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;@Bieber&lt;/a&gt; on Twitter). I&amp;rsquo;m using Google Apps Script for a variety of things these days and I am always interested to hear how others are using the same tools.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Running Firefox in the Cloud</title>
      <link>https://davidbieber.com/post/2014-11-08-firefox-in-the-cloud/</link>
      <pubDate>Sat, 08 Nov 2014 00:00:00 +0000</pubDate>
      <guid>https://davidbieber.com/post/2014-11-08-firefox-in-the-cloud/</guid>
      <description>&lt;p&gt;I found running Firefox in the cloud difficult, but with enough digging around I was able to get it working. Now I&amp;rsquo;m able to drive a headless version of Firefox with Selenium using Python. This lets me do things like have my 
&lt;a href=&#34;https://github.com/dbieber/ScrabbleBot&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Scrabble Bot&lt;/a&gt; play Words with Friends autonomously on Facebook.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;What am I going to show you how to do?&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;I&amp;rsquo;m going to explain how you can install Firefox and Selenium on a virtual machine in the cloud. I&amp;rsquo;m going to show this using a Debian instance on 
&lt;a href=&#34;https://cloud.google.com/compute/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Google Compute Engine&lt;/a&gt;, but you could also do this using a virtual machine from Amazon EC2.&lt;/p&gt;
&lt;p&gt;Before continuing you should create a virtual machine running Debian on Google Compute Engine (GCE). 
&lt;a href=&#34;https://cloud.google.com/compute/docs/quickstart&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;You can learn how to spin up a VM here&lt;/a&gt;. Make sure that you can SSH into your machine.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Installing Firefox&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;We&amp;rsquo;re actually going to install Iceweasel. To the best of my knowledge, the only difference between Iceweasel and Firefox is the branding. To do this, we&amp;rsquo;re going to:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Update the sources list that apt-get uses to find packages.
Edit the file &lt;code&gt;/etc/apt/sources.list&lt;/code&gt; and add the line &lt;code&gt;deb http://mozilla.debian.net/ wheezy-backports iceweasel-release&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Update apt-get by running the command &lt;code&gt;sudo apt-get update&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Install Iceweasel by running the command &lt;code&gt;sudo apt-get install -t wheezy-backports iceweasel&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;I figured this out by searching for &amp;ldquo;iceweasel sources list&amp;rdquo;, which brought me to 
&lt;a href=&#34;http://mozilla.debian.net/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;http://mozilla.debian.net/&lt;/a&gt;. If you&amp;rsquo;re looking to install a different version of Iceweasel/Firefox or have a different version of Debian, check there.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Running Firefox&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;We can now run the browser we installed with the command &lt;code&gt;firefox&lt;/code&gt; or &lt;code&gt;iceweasel&lt;/code&gt;, but it will shut down because there is no display. To run the browser without a display (that is, to run it &amp;ldquo;headlessly&amp;rdquo;), we&amp;rsquo;re going to:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Install the display server Xvfb (X virtual framebuffer) with the command &lt;code&gt;sudo apt-get install xvfb&lt;/code&gt;.&lt;/li&gt;
&lt;li&gt;Start the display server with the command &lt;code&gt;sudo Xvfb :10&lt;/code&gt;. Here, :10 is the server number we chose for the virtual display we&amp;rsquo;re creating.&lt;/li&gt;
&lt;li&gt;Now run &lt;code&gt;export DISPLAY=:10&lt;/code&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;You should now be able to run &lt;code&gt;firefox&lt;/code&gt; or &lt;code&gt;iceweasel&lt;/code&gt; successfully.&lt;/p&gt;
&lt;p&gt;If you&amp;rsquo;d like to see what&amp;rsquo;s on your virtual display, 
&lt;a href=&#34;http://en.wikipedia.org/wiki/Xvfb#Usage_examples&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Wikipedia provides an example of how to take a screenshot of your virtual display&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Installing Selenium&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;We can now run a headless version of Firefox. Since there&amp;rsquo;s no user interface to click around in, the next logical step is to learn how to drive the browser. For this, we&amp;rsquo;re going to set up Selenium in Python. When dealing with packages in Python, I recommend using pip inside a virtualenv with virtualenvwrapper. There are instructions for setting up these packages below.&lt;/p&gt;
&lt;p&gt;Once you have virtualenvwrapper installed and you&amp;rsquo;re safely working in a virtual environment, just issue the command &lt;code&gt;pip install selenium&lt;/code&gt; to install selenium. If you&amp;rsquo;re not in a virtualenv, you may need to issue the command with sudo.&lt;/p&gt;
&lt;p&gt;Try running this Python script to see if it&amp;rsquo;s all working. It should take you to Google Images, search for cute kittens, and then save a screenshot to the file &amp;lsquo;adorable.png&amp;rsquo;.&lt;/p&gt;
&lt;script src=&#34;https://gist.github.com/dbieber/1c4a7bdca8f9820b3612.js&#34;&gt;&lt;/script&gt;
&lt;p&gt;&lt;strong&gt;Installing virtualenvwrapper&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;As promised above, here is a section about virtualenvwrapper.&lt;/p&gt;
&lt;p&gt;Managing Python packages effectively is difficult, and I can&amp;rsquo;t do the topic justice here. I recommend using virtualenvwrapper to help, and 
&lt;a href=&#34;http://virtualenvwrapper.readthedocs.org/en/latest/install.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;you can read more about how to do this here&lt;/a&gt;. For completeness, I&amp;rsquo;ll briefly run through the steps of getting set up with pip, virtualenv, and virtualenvwrapper.&lt;/p&gt;
&lt;p&gt;&lt;code&gt;pip&lt;/code&gt; is Python&amp;rsquo;s package manager. Once you have pip set up, you can run &lt;code&gt;pip install package-name&lt;/code&gt; to install the package called package-name.&lt;/p&gt;
&lt;p&gt;To set up pip, run the following commands:&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;code&gt;curl https://bootstrap.pypa.io/get-pip.py &amp;gt; get-pip.py&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;&lt;code&gt;sudo python get-pip.py&lt;/code&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;code&gt;virtualenv&lt;/code&gt; is a tool that let&amp;rsquo;s you have different versions of Python and Python packages for different projects that you work on. Combined with &lt;code&gt;virtualenvwrapper&lt;/code&gt;, it will help you avoid headaches of keeping track of where your various Python versions live and where they can find their packages on your machine.&lt;/p&gt;
&lt;p&gt;To install virtualenv, run the command &lt;code&gt;sudo pip install virtualenv&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;To install virtualenvwrapper, run the command &lt;code&gt;sudo pip install virtualenvwrapper&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Add the following three lines to your .bashrc or another startup script:&lt;/p&gt;
&lt;p&gt;&lt;code&gt;export WORKON_HOME=$HOME/.virtualenvs&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;export PROJECT_HOME=$HOME/Devel&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;code&gt;source /usr/local/bin/virtualenvwrapper.sh&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;You&amp;rsquo;re now ready to go. 
&lt;a href=&#34;http://virtualenvwrapper.readthedocs.org/en/latest/command_ref.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;Learn more about how to use virtualenvwrapper effectively here&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Last thoughts&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;I hope you find this helpful. You can now install Firefox on Google Compute Engine, run it using a virtual display, and drive it using Selenium with Python. If something isn&amp;rsquo;t working, or if something is working really well and has you super excited, I&amp;rsquo;m happy to talk it through with you. Email&amp;rsquo;s the best way to contact me. Go forth and automate your life!&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Automate Your Life: Sending Emails</title>
      <link>https://davidbieber.com/post/2013-03-13-automate-your-life-sending-emails/</link>
      <pubDate>Wed, 13 Mar 2013 00:00:00 +0000</pubDate>
      <guid>https://davidbieber.com/post/2013-03-13-automate-your-life-sending-emails/</guid>
      <description>&lt;p&gt;&lt;em&gt;In a hurry? Scroll down and skip to the code. That&amp;rsquo;s the good part anyway.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;One of the beauties of programming is the elimination of redundant aspects of life that you find yourself doing over and over again. When you find yourself calling home every weekend, logging hours at your job daily, or getting your hair cut every month, it&amp;rsquo;s time to learn to program. Write a short script to do these repetitive behaviors for you. Just kidding. Don&amp;rsquo;t.&lt;/p&gt;
&lt;p&gt;These are joke examples &amp;ndash; I strongly advise against automating discussions with your mother &amp;ndash; but they aren&amp;rsquo;t so farfetched. Automating processes - shopping, shipping, server maintenance - save countless hours and dollars. Here, we&amp;rsquo;ll do a thought experiment: imagine a team of people running Amazon.com without automation. As a crude estimate, let&amp;rsquo;s suppose they sell a mere billion books each year. Let&amp;rsquo;s imagine they only handle 1% of all Internet traffic. And let&amp;rsquo;s pretend they only store 1 trillion objects in their S3 storage system. Then with their team of about ninety thousand, each Amazon employee would have to be selling and shipping 30 books a day on top of processing and transmitting over 100 gigabytes of Internet traffic daily, all while handling requests for a hundred thousand S3 objects that they&amp;rsquo;ve had to memorize. Maybe &lt;a href=&#34;http://en.wikipedia.org/wiki/Jeff_Bezos&#34;&gt;Jeff Bezos&lt;/a&gt; could pull it off. But you&amp;rsquo;re not Jeff Bezos, so I&amp;rsquo;d say it&amp;rsquo;s worth your time to learn to automate.&lt;/p&gt;
&lt;p&gt;Even education is being automated these days. Will the next century&amp;rsquo;s robotic overloads prove to be better professors than the ones we grew up with? To which you may reply: &amp;ldquo;Oh gee whiz! I sure hope we get better robotic overloads in the future! The ones I grew up with were just miserable professors.&amp;rdquo; But that&amp;rsquo;s not what I meant. I&amp;rsquo;m asking whether &lt;a href=&#34;http://khanacademy.org/&#34;&gt;Khan Academies&lt;/a&gt; and &lt;a href=&#34;http://duolingo.com/&#34;&gt;Duolingos&lt;/a&gt; will replace our real life Ms. Frizzles and Mrs. Gorfs. A brief excursion with Duolingo makes me suspect it will be a major part of all future language educations. This seems counterintuitive. Languages are inherently about communication. The best way to learn a language should necessarily involve communicating (and the very best way will probably forever remain immersion, but often that&amp;rsquo;s not an option). Conversation and human interaction are so fundamental to language learning that it seems almost absurd that a computer could be a good language teacher, at least until we have &lt;a href=&#34;http://en.wikipedia.org/wiki/Strong_AI&#34;&gt;strong AI&lt;/a&gt;. But the computer manages to do one thing extraordinarily well that isn&amp;rsquo;t scalable in a traditional classroom; the computer focuses entirely on me. So, yes, it lacks creativity and the personal touch of a great teacher. It doesn&amp;rsquo;t tell funny stories or crack foreign language jokes. It doesn&amp;rsquo;t show cute movies and it can&amp;rsquo;t relate to me at all. Yet despite all these shortcomings, it&amp;rsquo;s remarkably good at helping me learn the basics of a foreign language, because it can focus on me, going at my pace and not having to devote its efforts to maintaining the attention of 30 other students.&lt;/p&gt;
&lt;p&gt;Automation has clearly been taking over everywhere for years. You have to join it. &lt;a href=&#34;http://www.youtube.com/watch?v=nKIu9yen5nc&#34;&gt;It&amp;rsquo;s a real life superpower.&lt;/a&gt;  So let&amp;rsquo;s learn to automate something basic. We&amp;rsquo;ll go with software: a Python script to send emails.&lt;/p&gt;
&lt;p&gt;I present: the code. You can run it as is. Save it as a file and run it with Python, and it should just work out of the box. Go ahead, try it.&lt;/p&gt;
&lt;script src=&#34;https://gist.github.com/dbieber/5146518.js&#34;&gt;&lt;/script&gt;
&lt;p&gt;Awesome. You just sent me an email. What good is this code? Tweak it a bit and you can use it for personal alerts &amp;ndash; systematically check when you&amp;rsquo;re low on milk and email yourself a reminder &amp;ndash; have your computer email you daily with upcoming birthdays; you can even have it buy the gifts. You can email yourself automatically when a course opens up on your registrar&amp;rsquo;s website. We&amp;rsquo;ll talk about auto-enrolling another time. Or you can set up a script to send different versions of emails to different people, like those spam emails that pretend to be personal by including your first name.&lt;/p&gt;
&lt;p&gt;With great power comes great responsibility. Don&amp;rsquo;t send spam.&lt;/p&gt;
&lt;p&gt;With a new Python library in your toolbox, I hope you save yourself thousands of hours. Until next time, try to stay &lt;a href=&#34;http://en.wikipedia.org/wiki/Don&#39;t_repeat_yourself&#34;&gt;dry&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;&lt;a href=&#34;https://news.ycombinator.com/item?id=5371430&#34;&gt;Discuss on Hacker News.&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
